import{_ as L}from"./bgxFSIxJ.js";import{_ as S,a as E,b as R,d as z,e as D,c as F}from"./Bc_9lAEa.js";import{p as H,f as K,r as C,l as Q,o as r,g as v,w as t,a,i as h,b as o,C as M,c as f,F as $,y as k,D as V,d as l,z as G,t as p,j as J}from"./Cmpe_WKc.js";import{_ as O}from"./DoUMQrUc.js";import{u as W}from"./Cwv5lE_Z.js";import"./BDck7c17.js";import"./C8DqakIB.js";const X={class:"px-4 py-4"},Y={class:"grid grid-cols-1 gap-4 px-3 py-2"},Z={class:"flex flex-col gap-2 border border-blue-700 rounded-lg"},ee={key:0,class:"absolute z-10 mt-10 overflow-y-auto bg-white border rounded-md shadow-md w-[500px] max-h-60"},te=["onClick"],oe={class:"font-semibold"},se={class:"mt-4"},me=H({__name:"adjustment",setup(le){const{product:T}=W(),_=K(),d=C(""),u=C([]),j=J(),y=Q(()=>d.value?T.value.filter(n=>n.productName.toLowerCase().includes(d.value.toLowerCase())||n.productCode.toLowerCase().includes(d.value.toLowerCase())):[]),q=n=>{u.value.some(i=>i.productId===n.productId)||u.value.push({...n,quantity:1}),d.value=""},N=n=>{u.value.splice(n,1)},P=async()=>{if(u.value.some(e=>e.quantity<=0)){_.add({title:"Please enter a valid quantity for all products."});return}try{for(const e of u.value){const i={addQuantity:e.quantity};await $fetch(`${j.public.apiBaseUrl}/api/v1/product/add/${e.productId}`,{method:"PUT",body:i})}_.add({title:"adjustment saved successfully!"}),u.value=[]}catch{_.add({title:"Error saving adjustment."})}};return(n,e)=>{const i=L,c=S,g=E,B=R,m=D,x=G,U=F,A=z,I=O;return r(),v(I,{class:"w-full"},{default:t(()=>[a("div",X,[e[9]||(e[9]=a("div",{class:"flex justify-between px-3"},[a("div",{class:"text-blue-700"},[a("h2",null,"Add Adjustment"),a("p",{class:"text-blue-700 opacity-70"},"Add products quantity")])],-1)),a("form",{onSubmit:h(P,["prevent"])},[a("div",Y,[a("div",Z,[o(i,{variants:"ghost",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),type:"text",onKeydown:e[1]||(e[1]=M(h(()=>{},["prevent"]),["enter"])),placeholder:"Search product...",class:"block w-full border-blue-500 rounded-lg focus:border-blue-700 focus:ring-2 focus:ring-blue-200"},null,8,["modelValue"]),y.value.length&&d.value?(r(),f("ul",ee,[(r(!0),f($,null,k(y.value,s=>(r(),f("li",{key:s.productId,onClick:b=>q(s),class:"px-4 py-2 cursor-pointer hover:bg-gray-100"},[l(p(s.productName)+" - ",1),a("span",oe,p(s.productCode),1)],8,te))),128))])):V("",!0)]),u.value.length?(r(),v(A,{key:0,class:""},{default:t(()=>[o(B,{class:"text-blue-700"},{default:t(()=>[o(g,{class:"font-semibold text-blue-700 border-b border-blue-200"},{default:t(()=>[o(c,{class:""},{default:t(()=>e[2]||(e[2]=[l("No")])),_:1}),o(c,{class:""},{default:t(()=>e[3]||(e[3]=[l("Product")])),_:1}),o(c,{class:""},{default:t(()=>e[4]||(e[4]=[l("Code")])),_:1}),o(c,{class:""},{default:t(()=>e[5]||(e[5]=[l("Quantity")])),_:1}),o(c,{class:""},{default:t(()=>e[6]||(e[6]=[l("Action")])),_:1})]),_:1})]),_:1}),(r(!0),f($,null,k(u.value,(s,b)=>(r(),v(U,{key:s.productId,class:"transition duration-200 border-b border-blue-200 rounded-lg justify-evenly hover:border-blue-300"},{default:t(()=>[o(g,{class:"overflow-y-auto max-h-64"},{default:t(()=>[o(m,null,{default:t(()=>[l(p(b+1),1)]),_:2},1024),o(m,null,{default:t(()=>[l(p(s.productName),1)]),_:2},1024),o(m,null,{default:t(()=>[l(p(s.productCode),1)]),_:2},1024),o(m,null,{default:t(()=>[o(i,{variants:"ghost",modelValue:s.quantity,"onUpdate:modelValue":w=>s.quantity=w,type:"number",placeholder:"Enter quantity",class:"border-blue-200 rounded-lg hover:border-blue-300",min:"1"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(m,null,{default:t(()=>[o(x,{icon:"lucide:x",variant:"ghost",onClick:w=>N(b),class:"text-red-600 hover:bg-red-100"},{default:t(()=>e[7]||(e[7]=[l(" Remove ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),a("div",se,[o(x,{type:"submit",class:"text-blue-800 bg-blue-200 hover:bg-blue-100"},{default:t(()=>e[8]||(e[8]=[l(" Save Adjustment ")])),_:1})])]),_:1})):V("",!0)])],32)])]),_:1})}}});export{me as default};
