import{r as a,f as j,k as E,l as I,m as N,n as k,j as z}from"./Cmpe_WKc.js";import{a as B}from"./C8DqakIB.js";function H(){const m=a(null),i=j(),P=a(!1),r=z(),v=4,M=10,s=a(1),p=a(0),u=a([]),c=a(""),f=a("");a(0);const g=async()=>{P.value=!0,m.value=null;let e=`${r.public.apiBaseUrl}/api/v1/product?pageNumber=${s.value}`;c.value?e=`${r.public.apiBaseUrl}/api/v1/product/search?searchText=${encodeURIComponent(c.value)}&pageNumber=${s.value}`:f.value&&(e=`${r.public.apiBaseUrl}/api/v1/product/find?text=${encodeURIComponent(f.value)}`);try{const l=(await B.get(e)).data;c.value||f.value?u.value=Array.isArray(l.content)?l.content:[]:(p.value=l.totalRecords,u.value=l.content)}catch(t){console.error("Fetch Error:",t),m.value="Failed to fetch data"}finally{P.value=!1}},b=async e=>{try{await B.delete(`${r.public.apiBaseUrl}/api/v1/product/delete?productId=${e}`),i.add({title:"Successfully deleted Product!"}),window.location.reload()}catch{i.add({title:"error",description:"Failed to delete."})}};E(()=>{c.value!==""&&g(),g()});const U=e=>{e<1||e>y.value||(s.value=e,g())},y=I(()=>p.value>0?Math.ceil(p.value/M):1),R=I(()=>{const e=[];let t=Math.max(s.value-Math.floor(v/2),1),l=Math.min(t+v-1,y.value);l-t<v-1&&(t=Math.max(l-v+1,1));for(let d=t;d<=l;d++)e.push(d);return e}),S=e=>{if(!e)return"-";const t=new Date(e),l=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0");return`${String(t.getDate()).padStart(2,"0")}-${d}-${l}`},$=a(!1),x=a(""),w=a("view"),F=e=>{e.length===1&&(x.value=e[0],w.value="view",$.value=!0)},A=e=>{e.length===1&&(x.value=e[0],w.value="edit",$.value=!0)},T=N(),o=a([]),n=a(!1),h=a(!1),C=()=>{n.value?o.value=u.value.map(e=>e.productId):o.value=[]},D=e=>{const t=o.value.indexOf(e);t>-1?o.value.splice(t,1):o.value.push(e)};return k(o,e=>{e.length===0?(n.value=!1,h.value=!1):e.length===u.value.length?(n.value=!0,h.value=!1):(n.value=!1,h.value=!0)}),{product:u,error:m,searchText:c,findText:f,currentPage:s,totalRecords:p,totalPages:y,paginatedPages:R,fetchProduct:g,changePage:U,formatDate:S,deleteProduct:b,deleteProductsByIds:e=>{try{const t=B.delete(`${r.public.apiBaseUrl}/api/v1/product/delete?productId=${e.join(",")}`);i.add({title:"Product deleted successfully!"}),o.value=[],T.push({path:"/inventory/product"})}catch{i.add({title:"Failed to delete product"})}},showModal:$,selectedProductId:x,modalMode:w,viewProductById:F,editProductById:A,loading:P,selectAll:n,indeterminate:h,toggleSelectAll:C,toggleProduct:D,selectedProducts:o}}export{H as u};
