import{aE as et}from"./DgWlP6BF.js";function it(S,c){for(var o=0;o<c.length;o++){const f=c[o];if(typeof f!="string"&&!Array.isArray(f)){for(const a in f)if(a!=="default"&&!(a in S)){const n=Object.getOwnPropertyDescriptor(f,a);n&&Object.defineProperty(S,a,n.get?n:{enumerable:!0,get:()=>f[a]})}}}return Object.freeze(Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}))}var K={exports:{}};(function(S){(function(c){S.exports?(c.default=c,S.exports=c):c(typeof Highcharts<"u"?Highcharts:void 0)})(function(c){var o=c?c._modules:{};function f(a,n,I,C){a.hasOwnProperty(n)||(a[n]=C.apply(null,I),typeof CustomEvent=="function"&&c.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:n,module:a[n]}})))}f(o,"Series/GeoHeatmap/GeoHeatmapPoint.js",[o["Core/Utilities.js"],o["Core/Series/SeriesRegistry.js"]],function(a,n){let{map:{prototype:{pointClass:I}}}=n.seriesTypes,{isNumber:C}=a;return class extends I{applyOptions(U,g){let l=super.applyOptions.call(this,U,g),{lat:u,lon:b}=l.options;if(C(b)&&C(u)){let{colsize:j=1,rowsize:H=1}=this.series.options,v=b-j/2,O=u-H/2;l.geometry=l.options.geometry={type:"Polygon",coordinates:[[[v,O],[v+j,O],[v+j,O+H],[v,O+H],[v,O]]]}}return l}}}),f(o,"Series/InterpolationUtilities.js",[o["Core/Globals.js"],o["Core/Utilities.js"]],function(a,n){let{doc:I}=a,{defined:C,pick:U}=n;return{colorFromPoint:function(g,l){let u=l.series.colorAxis;if(u){let b=u.toColor(g||0,l).split(")")[0].split("(")[1].split(",").map(j=>U(parseFloat(j),parseInt(j,10)));return b[3]=255*U(b[3],1),C(g)&&l.visible||(b[3]=0),b}return[0,0,0,0]},getContext:function(g){let{canvas:l,context:u}=g;return l&&u?(u.clearRect(0,0,l.width,l.height),u):(g.canvas=I.createElement("canvas"),g.context=g.canvas.getContext("2d",{willReadFrequently:!0})||void 0,g.context)}}}),f(o,"Series/GeoHeatmap/GeoHeatmapSeries.js",[o["Core/Animation/AnimationUtilities.js"],o["Series/GeoHeatmap/GeoHeatmapPoint.js"],o["Core/Globals.js"],o["Series/InterpolationUtilities.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(a,n,I,C,U,g){let{animObject:l,stop:u}=a,{noop:b}=I,{colorFromPoint:j,getContext:H}=C,{seriesTypes:{map:v}}=U,{addEvent:O,extend:B,isNumber:Y,isObject:Q,merge:z,pick:F}=g;function $(_){return _-360*Math.floor((_+180)/360)}class R extends v{constructor(){super(...arguments),this.isDirtyCanvas=!0}update(){this.options=z(this.options,arguments[0]),this.getInterpolation().enabled&&(this.isDirtyCanvas=!0,this.points.forEach(e=>{e.graphic&&(e.graphic.destroy(),delete e.graphic)})),super.update.apply(this,arguments)}translate(){(!this.getInterpolation().enabled||!this.image||this.isDirty||this.isDirtyData)&&super.translate.apply(this,arguments)}getInterpolation(){return Q(this.options.interpolation)?this.options.interpolation:{blur:1,enabled:this.options.interpolation}}drawPoints(){let e=this.chart.mapView,A=this.options;if(this.getInterpolation().enabled&&e&&this.bounds){let i=this.context||H(this),{canvas:t,colorAxis:p,image:s,chart:L,points:w}=this,[k,M]=[F(A.colsize,1),F(A.rowsize,1)],T=e.projectedUnitsToPixels({x:this.bounds.x1,y:this.bounds.y2}),E=e.projectedUnitsToPixels({x:this.bounds.x2,y:this.bounds.y1});if(t&&i&&p&&T&&E){let h={x:T.x,y:T.y,width:E.x-T.x,height:E.y-T.y};if(this.isDirtyCanvas||this.isDirtyData||e.projection.options.name==="Orthographic"){this.isDirtyCanvas=!0;let r=t.width=~~(360/k)+1,x=t.height=~~(180/M)+1,d=new Uint8ClampedArray(r*x*4);this.directTouch=!1;for(let X=0;X<w.length;X++){let V=w[X],tt=new Uint8ClampedArray(j(V.value,V)),{lon:q,lat:J}=V.options;Y(q)&&Y(J)&&d.set(tt,4*Math.ceil(r*(x-1-(J+90)/M)+(q+180)/k))}let D=this.getInterpolation().blur,P=D===0?1:11*D,m=~~h.width,y=~~h.height,N=new ImageData(d,r,x);t.width=~~(r*P),t.height=~~(x*P),i.putImageData(N,0,0),i.globalCompositeOperation="copy",i.drawImage(t,0,0,N.width,N.height,0,0,t.width,t.height);let G=i.getImageData(0,0,t.width,t.height),Z=new ImageData(this.getProjectedImageData(e,m,y,G,t,h.x,h.y),m,y);i.globalCompositeOperation="copy",t.width=m,t.height=y,i.putImageData(Z,0,0)}if(s)if(L.renderer.globalAnimation&&L.hasRendered){let r=Number(s.attr("x")),x=Number(s.attr("y")),d=Number(s.attr("width")),D=Number(s.attr("height")),P=(N,G)=>{s.attr({x:r+(h.x-r)*G.pos,y:x+(h.y-x)*G.pos,width:d+(h.width-d)*G.pos,height:D+(h.height-D)*G.pos})},m=z(l(L.renderer.globalAnimation)),y=m.step;m.step=function(){y&&y.apply(this,arguments),P.apply(this,arguments)},s.attr(z({animator:0},this.isDirtyCanvas?{href:t.toDataURL("image/png",1)}:void 0)).animate({animator:1},m)}else u(s),s.attr(z(h,this.isDirtyCanvas?{href:t.toDataURL("image/png",1)}:void 0));else this.image=L.renderer.image(t.toDataURL("image/png",1)).attr(h).add(this.group);this.isDirtyCanvas=!1}}else super.drawPoints.apply(this,arguments)}getProjectedImageData(e,A,i,t,p,s,L){var h;let w=new Uint8ClampedArray(A*i*4),k=F((h=e.projection.options.rotation)==null?void 0:h[0],0),M=p.width/360,T=-1*p.height/180,E=-1;for(let r=0;r<w.length;r+=4){let x=r/4%A;x===0&&E++;let d=e.pixelsToLonLat({x:s+x,y:L+E});if(d){d.lon>-180-k&&d.lon<180-k&&(d.lon=$(d.lon));let D=[d.lon,d.lat],P=D[0]*M+p.width/2,m=D[1]*T+p.height/2;if(P>=0&&P<=p.width&&m>=0&&m<=p.height){let y=Math.floor(m)*p.width*4+4*Math.round(P);w[r]=t.data[y],w[r+1]=t.data[y+1],w[r+2]=t.data[y+2],w[r+3]=t.data[y+3]}}}return w}searchPoint(e,A){let i=this.chart,t=i.mapView;if(t&&this.bounds&&this.image&&i.tooltip&&i.tooltip.options.enabled)if(!i.pointer.hasDragged&&(.01>=+this.image.attr("animator")||+this.image.attr("animator")>=.99)){let p=t.projectedUnitsToPixels({x:this.bounds.x1,y:this.bounds.y2}),s=t.projectedUnitsToPixels({x:this.bounds.x2,y:this.bounds.y1});if(i.pointer.normalize(e),e.lon&&e.lat&&p&&s&&e.chartX-i.plotLeft>p.x&&e.chartX-i.plotLeft<s.x&&e.chartY-i.plotTop>p.y&&e.chartY-i.plotTop<s.y)return this.searchKDTree({clientX:e.chartX,lon:$(e.lon),lat:e.lat},A,e)}else i.tooltip.destroy()}}return R.defaultOptions=z(v.defaultOptions,{nullColor:"transparent",tooltip:{pointFormat:"Lat: {point.lat}, Lon: {point.lon}, Value: {point.value}<br/>"},borderWidth:0,colsize:1,rowsize:1,stickyTracking:!0,interpolation:{enabled:!1,blur:1}}),O(R,"afterDataClassLegendClick",function(){this.isDirtyCanvas=!0,this.drawPoints()}),B(R.prototype,{type:"geoheatmap",applyJitter:b,pointClass:n,pointArrayMap:["lon","lat","value"],kdAxisArray:["lon","lat"]}),U.registerSeriesType("geoheatmap",R),R}),f(o,"masters/modules/geoheatmap.src.js",[o["Core/Globals.js"]],function(a){return a})})})(K);var W=K.exports;const ot=et(W),st=it({__proto__:null,default:ot},[W]);export{st as g};
