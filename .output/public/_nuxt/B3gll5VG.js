import{aE as Y}from"./DgWlP6BF.js";function k(S,E){for(var w=0;w<E.length;w++){const v=E[w];if(typeof v!="string"&&!Array.isArray(v)){for(const d in v)if(d!=="default"&&!(d in S)){const b=Object.getOwnPropertyDescriptor(v,d);b&&Object.defineProperty(S,d,b.get?b:{enumerable:!0,get:()=>v[d]})}}}return Object.freeze(Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}))}var V={exports:{}};(function(S){(function(E){S.exports?(E.default=E,S.exports=E):E(typeof Highcharts<"u"?Highcharts:void 0)})(function(E){var w=E?E._modules:{};function v(d,b,y,c){d.hasOwnProperty(b)||(d[b]=c.apply(null,y),typeof CustomEvent=="function"&&E.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:b,module:d[b]}})))}v(w,"Data/Modifiers/DataModifier.js",[w["Core/Utilities.js"]],function(d){var b;let{addEvent:y,fireEvent:c,merge:g}=d;class s{benchmark(t,e){let r=[],o=this,i=()=>{o.modifyTable(t),o.emit({type:"afterBenchmarkIteration"})},{iterations:a}=g({iterations:1},e);o.on("afterBenchmarkIteration",()=>{if(r.length===a){o.emit({type:"afterBenchmark",results:r});return}i()});let l={startTime:0,endTime:0};return o.on("modify",()=>{l.startTime=window.performance.now()}),o.on("afterModify",()=>{l.endTime=window.performance.now(),r.push(l.endTime-l.startTime)}),i(),r}emit(t){c(this,t.type,t)}modify(t,e){let r=this;return new Promise((o,i)=>{t.modified===t&&(t.modified=t.clone(!1,e));try{o(r.modifyTable(t,e))}catch(a){r.emit({type:"error",detail:e,table:t}),i(a)}})}modifyCell(t,e,r,o,i){return this.modifyTable(t)}modifyColumns(t,e,r,o){return this.modifyTable(t)}modifyRows(t,e,r,o){return this.modifyTable(t)}on(t,e){return y(this,t,e)}}return(b=s||(s={})).types={},b.registerType=function(n,t){return!!n&&!b.types[n]&&!!(b.types[n]=t)},s}),v(w,"Data/DataTable.js",[w["Core/Utilities.js"]],function(d){let{addEvent:b,defined:y,fireEvent:c,uniqueKey:g}=d;class s{static isNull(t){if(t===s.NULL)return!0;if(t instanceof Array){if(!t.length)return!1;for(let e=0,r=t.length;e<r;++e)if(t[e]!==null)return!1}else{let e=Object.keys(t);if(!e.length)return!1;for(let r=0,o=e.length;r<o;++r)if(t[e[r]]!==null)return!1}return!0}constructor(t={}){this.autoId=!t.id,this.columns={},this.id=t.id||g(),this.modified=this,this.rowCount=0,this.versionTag=g();let e=t.columns||{},r=Object.keys(e),o=this.columns,i=0;for(let a=0,l=r.length,f,h;a<l;++a)f=e[h=r[a]].slice(),o[h]=f,i=Math.max(i,f.length);for(let a=0,l=r.length;a<l;++a)o[r[a]].length=i;this.rowCount=i}clone(t,e){let r={};this.emit({type:"cloneTable",detail:e}),t||(r.columns=this.columns),this.autoId||(r.id=this.id);let o=new s(r);return t||(o.versionTag=this.versionTag,o.originalRowIndexes=this.originalRowIndexes,o.localRowIndexes=this.localRowIndexes),this.emit({type:"afterCloneTable",detail:e,tableClone:o}),o}deleteColumns(t,e){let r=this.columns,o={},i={},a=this.modifier,l=this.rowCount;if((t=t||Object.keys(r)).length){this.emit({type:"deleteColumns",columnNames:t,detail:e});for(let f=0,h=t.length,u,C;f<h;++f)(u=r[C=t[f]])&&(o[C]=u,i[C]=Array(l)),delete r[C];return Object.keys(r).length||(this.rowCount=0,this.deleteRowIndexReferences()),a&&a.modifyColumns(this,i,0,e),this.emit({type:"afterDeleteColumns",columns:o,columnNames:t,detail:e}),o}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(t,e=1,r){let o=[],i=[],a=this.modifier;if(this.emit({type:"deleteRows",detail:r,rowCount:e,rowIndex:t||0}),t===void 0&&(t=0,e=this.rowCount),e>0&&t<this.rowCount){let l=this.columns,f=Object.keys(l);for(let h=0,u=f.length,C,m;h<u;++h){m=(C=l[f[h]]).splice(t,e),h||(this.rowCount=C.length);for(let p=0,N=m.length;p<N;++p)o[p]=o[p]||[],o[p][h]=m[p];i.push(Array(u))}}return a&&a.modifyRows(this,i,t||0,r),this.emit({type:"afterDeleteRows",detail:r,rowCount:e,rowIndex:t||0,rows:o}),o}emit(t){switch(t.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=g()}c(this,t.type,t)}getCell(t,e){let r=this.columns[t];if(r)return r[e]}getCellAsBoolean(t,e){let r=this.columns[t];return!!(r&&r[e])}getCellAsNumber(t,e,r){let o=this.columns[t],i=o&&o[e];switch(typeof i){case"boolean":return i?1:0;case"number":return isNaN(i)&&!r?null:i}return isNaN(i=parseFloat(`${i??""}`))&&!r?null:i}getCellAsString(t,e){let r=this.columns[t];return`${r&&r[e]}`}getColumn(t,e){return this.getColumns([t],e)[t]}getColumnAsNumbers(t,e){let r=this.columns[t],o=[];if(r){let i=r.length;if(e)for(let a=0;a<i;++a)o.push(this.getCellAsNumber(t,a,!0));else{for(let a=0,l;a<i;++a){if(typeof(l=r[a])=="number")return r.slice();if(l!=null)break}for(let a=0;a<i;++a)o.push(this.getCellAsNumber(t,a))}}return o}getColumnNames(){return Object.keys(this.columns)}getColumns(t,e){let r=this.columns,o={};t=t||Object.keys(r);for(let i=0,a=t.length,l,f;i<a;++i)(l=r[f=t[i]])&&(o[f]=e?l:l.slice());return o}getLocalRowIndex(t){let{localRowIndexes:e}=this;return e?e[t]:t}getModifier(){return this.modifier}getOriginalRowIndex(t){let{originalRowIndexes:e}=this;return e?e[t]:t}getRow(t,e){return this.getRows(t,1,e)[0]}getRowCount(){return this.rowCount}getRowIndexBy(t,e,r){let o=this.columns[t];if(o){let i=o.indexOf(e,r);if(i!==-1)return i}}getRowObject(t,e){return this.getRowObjects(t,1,e)[0]}getRowObjects(t=0,e=this.rowCount-t,r){let o=this.columns,i=Array(e);r=r||Object.keys(o);for(let a=t,l=0,f=Math.min(this.rowCount,t+e),h,u;a<f;++a,++l)for(let C of(u=i[l]={},r))h=o[C],u[C]=h?h[a]:void 0;return i}getRows(t=0,e=this.rowCount-t,r){let o=this.columns,i=Array(e);r=r||Object.keys(o);for(let a=t,l=0,f=Math.min(this.rowCount,t+e),h,u;a<f;++a,++l)for(let C of(u=i[l]=[],r))h=o[C],u.push(h?h[a]:void 0);return i}getVersionTag(){return this.versionTag}hasColumns(t){let e=this.columns;for(let r=0,o=t.length;r<o;++r)if(!e[t[r]])return!1;return!0}hasRowWith(t,e){let r=this.columns[t];return!!r&&r.indexOf(e)!==-1}on(t,e){return b(this,t,e)}renameColumn(t,e){let r=this.columns;return!!r[t]&&(t!==e&&(r[e]=r[t],delete r[t]),!0)}setCell(t,e,r,o){let i=this.columns,a=this.modifier,l=i[t];l&&l[e]===r||(this.emit({type:"setCell",cellValue:r,columnName:t,detail:o,rowIndex:e}),l||(l=i[t]=Array(this.rowCount)),e>=this.rowCount&&(this.rowCount=e+1),l[e]=r,a&&a.modifyCell(this,t,e,r),this.emit({type:"afterSetCell",cellValue:r,columnName:t,detail:o,rowIndex:e}))}setColumn(t,e=[],r=0,o){this.setColumns({[t]:e},r,o)}setColumns(t,e,r){let o=this.columns,i=this.modifier,a=e===void 0,l=Object.keys(t);this.emit({type:"setColumns",columns:t,columnNames:l,detail:r,rowIndex:e});for(let h=0,u=l.length,C,m;h<u;++h)if(C=t[m=l[h]],a)o[m]=C.slice(),this.rowCount=C.length;else{let p=o[m]?o[m]:o[m]=Array(this.rowCount);for(let N=e||0,T=C.length;N<T;++N)p[N]=C[N];this.rowCount=Math.max(this.rowCount,p.length)}let f=Object.keys(o);for(let h=0,u=f.length;h<u;++h)o[f[h]].length=this.rowCount;i&&i.modifyColumns(this,t,e||0),this.emit({type:"afterSetColumns",columns:t,columnNames:l,detail:r,rowIndex:e})}setModifier(t,e){let r=this;return r.emit({type:"setModifier",detail:e,modifier:t,modified:r.modified}),r.modified=r,r.modifier=t,(t?t.modify(r):Promise.resolve(r)).then(o=>(o.emit({type:"afterSetModifier",detail:e,modifier:t,modified:o.modified}),o)).catch(o=>{throw r.emit({type:"setModifierError",error:o,modifier:t,modified:r.modified}),o})}setOriginalRowIndexes(t,e=!1){if(this.originalRowIndexes=t,e)return;let r=this.localRowIndexes=[];for(let o=0,i=t.length,a;o<i;++o)y(a=t[o])&&(r[a]=o)}setRow(t,e,r){this.setRows([t],e,r)}setRows(t,e=this.rowCount,r){let o=this.columns,i=Object.keys(o),a=this.modifier,l=t.length;this.emit({type:"setRows",detail:r,rowCount:l,rowIndex:e,rows:t});for(let h=0,u=e,C;h<l;++h,++u)if((C=t[h])===s.NULL)for(let m=0,p=i.length;m<p;++m)o[i[m]][u]=null;else if(C instanceof Array)for(let m=0,p=i.length;m<p;++m)o[i[m]][u]=C[m];else{let m=Object.keys(C);for(let p=0,N=m.length,T;p<N;++p)o[T=m[p]]||(o[T]=Array(u+1)),o[T][u]=C[T]}let f=e+l;if(f>this.rowCount){this.rowCount=f;for(let h=0,u=i.length;h<u;++h)o[i[h]].length=f}a&&a.modifyRows(this,t,e),this.emit({type:"afterSetRows",detail:r,rowCount:l,rowIndex:e,rows:t})}}return s.NULL={},s.version="1.0.0",s}),v(w,"Data/Connectors/DataConnector.js",[w["Data/Modifiers/DataModifier.js"],w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b,y){var c;let{addEvent:g,fireEvent:s,merge:n,pick:t}=y;class e{constructor(o={}){this.table=new b(o.dataTable),this.metadata=o.metadata||{columns:{}}}get polling(){return!!this.polling}describeColumn(o,i){let a=this.metadata.columns;a[o]=n(a[o]||{},i)}describeColumns(o){let i,a=Object.keys(o);for(;typeof(i=a.pop())=="string";)this.describeColumn(i,o[i])}emit(o){s(this,o.type,o)}getColumnOrder(o){let i=this.metadata.columns,a=Object.keys(i||{});if(a.length)return a.sort((l,f)=>t(i[l].index,0)-t(i[f].index,0))}getSortedColumns(o){return this.table.getColumns(this.getColumnOrder(o))}load(){return s(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(o,i){return g(this,o,i)}save(){return s(this,"saveError",{table:this.table}),Promise.reject(Error("Not implemented"))}setColumnOrder(o){for(let i=0,a=o.length;i<a;++i)this.describeColumn(o[i],{index:i})}setModifierOptions(o){let i=o&&d.types[o.type];return this.table.setModifier(i?new i(o):void 0).then(()=>this)}startPolling(o=1e3){let i=this;window.clearTimeout(i._polling),i._polling=window.setTimeout(()=>i.load().catch(a=>i.emit({type:"loadError",error:a,table:i.table})).then(()=>{i._polling&&i.startPolling(o)}),o)}stopPolling(){window.clearTimeout(this._polling),delete this._polling}whatIs(o){return this.metadata.columns[o]}}return(c=e||(e={})).types={},c.registerType=function(r,o){return!!r&&!c.types[r]&&!!(c.types[r]=o)},e}),v(w,"Data/Converters/DataConverter.js",[w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b){let{addEvent:y,fireEvent:c,isNumber:g,merge:s}=b;class n{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(i){return i?Date.UTC(+i[1],i[3]-1,+i[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(i){return i?Date.UTC(+i[4],i[3]-1,+i[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(i){return i?Date.UTC(+i[4],i[1]-1,+i[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(i){let a=new Date;if(!i)return NaN;let l=+i[4];return l>a.getFullYear()-2e3?l+=1900:l+=2e3,Date.UTC(l,i[3]-1,+i[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(i){return i?Date.UTC(+i[4]+2e3,i[1]-1,+i[3]):NaN}}};let r=s(n.defaultOptions,e),o=r.decimalPoint;(o==="."||o===",")&&(o=o==="."?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+o+"([0-9]+)$")),this.options=r}asBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e!==""&&e!=="0"&&e!=="false":!!this.asNumber(e)}asDate(e){let r;if(typeof e=="string")r=this.parseDate(e);else if(typeof e=="number")r=e;else{if(e instanceof Date)return e;r=this.parseDate(this.asString(e))}return new Date(r)}asGuessedType(e){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(e)].call(this,e)}asNumber(e){if(typeof e=="number")return e;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){let r=this.decimalRegExp;if(e.indexOf(" ")>-1&&(e=e.replace(/\s+/g,"")),r){if(!r.test(e))return NaN;e=e.replace(r,"$1.$2")}return parseFloat(e)}return e instanceof Date?e.getDate():e?e.getRowCount():NaN}asString(e){return""+e}deduceDateFormat(e,r,o){let i=[],a=[],l="YYYY/mm/dd",f,h=[],u=0,C=!1,m,p;for((!r||r>e.length)&&(r=e.length);u<r;u++)if(e[u]!==void 0&&e[u]&&e[u].length)for(p=0,f=e[u].trim().replace(/[\-\.\/]/g," ").split(" "),h=["","",""];p<f.length;p++)p<h.length&&(m=parseInt(f[p],10))&&(a[p]=!a[p]||a[p]<m?m:a[p],i[p]!==void 0?i[p]!==m&&(i[p]=!1):i[p]=m,m>31?m<100?h[p]="YY":h[p]="YYYY":m>12&&m<=31?(h[p]="dd",C=!0):h[p].length||(h[p]="mm"));if(C){for(p=0;p<i.length;p++)i[p]!==!1?a[p]>12&&h[p]!=="YY"&&h[p]!=="YYYY"&&(h[p]="YY"):a[p]>12&&h[p]==="mm"&&(h[p]="dd");h.length===3&&h[1]==="dd"&&h[2]==="dd"&&(h[2]="YY"),l=h.join("/")}return o&&(this.options.dateFormat=l),l}emit(e){c(this,e.type,e)}export(e,r){throw this.emit({type:"exportError",columns:[],headers:[]}),Error("Not implemented")}getTable(){throw Error("Not implemented")}guessType(e){let r="string";if(typeof e=="string"){let o=this.trim(`${e}`),i=this.decimalRegExp,a=this.trim(o,!0);i&&(a=i.test(a)?a.replace(i,"$1.$2"):"");let l=parseFloat(a);+a===l?e=l:r=g(this.parseDate(e))?"Date":"string"}return typeof e=="number"&&(r=e>31536e6?"Date":"number"),r}on(e,r){return y(this,e,r)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),Error("Not implemented")}parseDate(e,r){let o=this.options,i=r||o.dateFormat,a=NaN,l,f,h;if(o.parseDate)a=o.parseDate(e);else{if(i)(f=this.dateFormats[i])||(f=this.dateFormats["YYYY/mm/dd"]),(h=e.match(f.regex))&&(a=f.parser(h));else for(l in this.dateFormats)if(f=this.dateFormats[l],h=e.match(f.regex)){i=l,a=f.parser(h);break}!h&&(typeof(h=Date.parse(e))=="object"&&h!==null&&h.getTime?a=h.getTime()-6e4*h.getTimezoneOffset():g(h)&&(a=h-6e4*new Date(h).getTimezoneOffset(),e.indexOf("2001")===-1&&new Date(a).getFullYear()===2001&&(a=NaN)))}return a}trim(e,r){return typeof e=="string"&&(e=e.replace(/^\s+|\s+$/g,""),r&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}return n.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(n||(n={})).getTableFromColumns=function(t=[],e=[]){let r=new d;for(let o=0,i=Math.max(e.length,t.length);o<i;++o)r.setColumn(e[o]||`${o}`,t[o]);return r},n}),v(w,"Data/DataCursor.js",[],function(){class d{constructor(y={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=y}addListener(y,c,g){let s=this.listenerMap[y]=this.listenerMap[y]||{};return(s[c]=s[c]||[]).push(g),this}buildEmittingTag(y){return(y.cursor.type==="position"?[y.table.id,y.cursor.column,y.cursor.row,y.cursor.state,y.cursor.type]:[y.table.id,y.cursor.columns,y.cursor.firstRow,y.cursor.lastRow,y.cursor.state,y.cursor.type]).join("\0")}emitCursor(y,c,g,s){let n=y.id,t=c.state,e=this.listenerMap[n]&&this.listenerMap[n][t];if(e){let r=this.stateMap[n]=this.stateMap[n]??{},o=r[c.state]||[];s&&(o.length||(r[c.state]=o),d.getIndex(c,o)===-1&&o.push(c));let i={cursor:c,cursors:o,table:y};g&&(i.event=g);let a=this.emittingRegister,l=this.buildEmittingTag(i);if(a.indexOf(l)>=0)return this;try{this.emittingRegister.push(l);for(let f=0,h=e.length;f<h;++f)e[f].call(this,i)}finally{let f=this.emittingRegister.indexOf(l);f>=0&&this.emittingRegister.splice(f,1)}}return this}remitCursor(y,c){let g=this.stateMap[y]&&this.stateMap[y][c.state];if(g){let s=d.getIndex(c,g);s>=0&&g.splice(s,1)}return this}removeListener(y,c,g){let s=this.listenerMap[y]&&this.listenerMap[y][c];if(s){let n=s.indexOf(g);n>=0&&s.splice(n,1)}return this}}return d.version="1.0.0",function(b){function y(c,g){if(c.type==="range")return c;let s={type:"range",firstRow:c.row??(g&&g.firstRow)??0,lastRow:c.row??(g&&g.lastRow)??Number.MAX_VALUE,state:c.state};return c.column!==void 0&&(s.columns=[c.column]),s}b.getIndex=function(c,g){if(c.type==="position"){for(let s,n=0,t=g.length;n<t;++n)if((s=g[n]).type==="position"&&s.state===c.state&&s.column===c.column&&s.row===c.row)return n}else{let s=JSON.stringify(c.columns);for(let n,t=0,e=g.length;t<e;++t)if((n=g[t]).type==="range"&&n.state===c.state&&n.firstRow===c.firstRow&&n.lastRow===c.lastRow&&JSON.stringify(n.columns)===s)return t}return-1},b.isEqual=function(c,g){return c.type==="position"&&g.type==="position"?c.column===g.column&&c.row===g.row&&c.state===g.state:c.type==="range"&&g.type==="range"&&c.firstRow===g.firstRow&&c.lastRow===g.lastRow&&JSON.stringify(c.columns)===JSON.stringify(g.columns)},b.isInRange=function(c,g){g.type==="position"&&(g=y(g)),c.type==="position"&&(c=y(c,g));let s=c.columns,n=g.columns;return c.firstRow>=g.firstRow&&c.lastRow<=g.lastRow&&(!s||!n||s.every(t=>n.indexOf(t)>=0))},b.toPositions=function(c){if(c.type==="position")return[c];let g=c.columns||[],s=[],n=c.state;for(let t=c.firstRow,e=c.lastRow;t<e;++t){if(!g.length){s.push({type:"position",row:t,state:n});continue}for(let r=0,o=g.length;r<o;++r)s.push({type:"position",column:g[r],row:t,state:n})}return s},b.toRange=y}(d||(d={})),d}),v(w,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),v(w,"Data/DataPool.js",[w["Data/Connectors/DataConnector.js"],w["Data/DataPoolDefaults.js"],w["Core/Utilities.js"]],function(d,b,y){class c{constructor(s=b){s.connectors=s.connectors||[],this.connectors={},this.options=s,this.waiting={}}emit(s){y.fireEvent(this,s.type,s)}getConnector(s){let n=this.connectors[s];if(n)return Promise.resolve(n);let t=this.waiting[s];if(!t){t=this.waiting[s]=[];let e=this.getConnectorOptions(s);if(!e)throw Error(`Connector '${s}' not found.`);this.loadConnector(e).then(r=>{delete this.waiting[s];for(let o=0,i=t.length;o<i;++o)t[o][0](r)}).catch(r=>{delete this.waiting[s];for(let o=0,i=t.length;o<i;++o)t[o][1](r)})}return new Promise((e,r)=>{t.push([e,r])})}getConnectorIds(){let s=this.options.connectors,n=[];for(let t=0,e=s.length;t<e;++t)n.push(s[t].id);return n}getConnectorOptions(s){let n=this.options.connectors;for(let t=0,e=n.length;t<e;++t)if(n[t].id===s)return n[t]}getConnectorTable(s){return this.getConnector(s).then(n=>n.table)}isNewConnector(s){return!this.connectors[s]}loadConnector(s){return new Promise((n,t)=>{this.emit({type:"load",options:s});let e=d.types[s.type];if(!e)throw Error(`Connector type not found. (${s.type})`);new e(s.options).load().then(r=>{this.connectors[s.id]=r,this.emit({type:"afterLoad",options:s}),n(r)}).catch(t)})}on(s,n){return y.addEvent(this,s,n)}setConnectorOptions(s){let n=this.options.connectors,t=this.connectors;this.emit({type:"setConnectorOptions",options:s});for(let e=0,r=n.length;e<r;++e)if(n[e].id===s.id){n.splice(e,1);break}t[s.id]&&(t[s.id].stopPolling(),delete t[s.id]),n.push(s),this.emit({type:"afterSetConnectorOptions",options:s})}}return c.version="1.0.0",c}),v(w,"Data/Formula/FormulaParser.js",[],function(){let d=/^(?:FALSE|TRUE)/,b=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,y=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,c=/^([A-Z][A-Z\d\.]*)\(/,g=/^(?:[+\-*\/^<=>]|<=|=>)/,s=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,n=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,t=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,e=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function r(f){let h=0;for(let u=0,C=f.length,m,p=1;u<C;++u){if((m=f[u])==="("){h||(p=u+1),++h;continue}if(m===")"&&!--h)return f.substring(p,u)}if(h>0){let u=Error("Incomplete parantheses.");throw u.name="FormulaParseError",u}return""}function o(f){let h=-1;for(let C=0,m=f.length,p,N=!1;C<m;++C){if((p=f[C])==="\\"){N=!N;continue}if(N){N=!1;continue}if(p==='"'){if(!(h<0))return f.substring(h+1,C);h=C}}let u=Error("Incomplete string.");throw u.name="FormulaParseError",u}function i(f,h){let u;if(u=f.match(n)){let m=u[2]===""||u[2][0]==="[",p=u[1]===""||u[1][0]==="[",N=u[4]===""||u[4][0]==="[",T=u[3]===""||u[3][0]==="[",F={type:"range",beginColumn:m?parseInt(u[2].substring(1,-1)||"0",10):parseInt(u[2],10)-1,beginRow:p?parseInt(u[1].substring(1,-1)||"0",10):parseInt(u[1],10)-1,endColumn:N?parseInt(u[4].substring(1,-1)||"0",10):parseInt(u[4],10)-1,endRow:T?parseInt(u[3].substring(1,-1)||"0",10):parseInt(u[3],10)-1};return m&&(F.beginColumnRelative=!0),p&&(F.beginRowRelative=!0),N&&(F.endColumnRelative=!0),T&&(F.endRowRelative=!0),F}if(u=f.match(s)){let m=u[1][0]!=="$",p=u[2][0]!=="$",N=u[3][0]!=="$",T=u[4][0]!=="$",F={type:"range",beginColumn:l(m?u[1]:u[1].substring(1))-1,beginRow:parseInt(p?u[2]:u[2].substring(1),10)-1,endColumn:l(N?u[3]:u[3].substring(1))-1,endRow:parseInt(T?u[4]:u[4].substring(1),10)-1};return m&&(F.beginColumnRelative=!0),p&&(F.beginRowRelative=!0),N&&(F.endColumnRelative=!0),T&&(F.endRowRelative=!0),F}let C=a(f,h);return C.length===1&&typeof C[0]!="string"?C[0]:C}function a(f,h){let u=h?y:b,C=[],m,p=(f[0]==="="?f.substring(1):f).trim();for(;p;){if(m=p.match(e)){let F=m[2]===""||m[2][0]==="[",D=m[1]===""||m[1][0]==="[",R={type:"reference",column:F?parseInt(m[2].substring(1,-1)||"0",10):parseInt(m[2],10)-1,row:D?parseInt(m[1].substring(1,-1)||"0",10):parseInt(m[1],10)-1};F&&(R.columnRelative=!0),D&&(R.rowRelative=!0),C.push(R),p=p.substring(m[0].length).trim();continue}if(m=p.match(t)){let F=m[1][0]!=="$",D=m[2][0]!=="$",R={type:"reference",column:l(F?m[1]:m[1].substring(1))-1,row:parseInt(D?m[2]:m[2].substring(1),10)-1};F&&(R.columnRelative=!0),D&&(R.rowRelative=!0),C.push(R),p=p.substring(m[0].length).trim();continue}if(m=p.match(g)){C.push(m[0]),p=p.substring(m[0].length).trim();continue}if(m=p.match(d)){C.push(m[0]==="TRUE"),p=p.substring(m[0].length).trim();continue}if(m=p.match(u)){C.push(parseFloat(m[0])),p=p.substring(m[0].length).trim();continue}if(p[0]==='"'){let F=o(p);C.push(F.substring(1,-1)),p=p.substring(F.length+2).trim();continue}if(m=p.match(c)){let F=r(p=p.substring(m[1].length).trim());C.push({type:"function",name:m[1],args:function(D,R){let j=[],O=R?";":",",A=0,x="";for(let M=0,L=D.length,P;M<L;++M)if((P=D[M])===O&&!A&&x)j.push(i(x,R)),x="";else if(P!=='"'||A||x)P!==" "&&(x+=P,P==="("?++A:P===")"&&--A);else{let I=o(D.substring(M));j.push(I),M+=I.length+1}return!A&&x&&j.push(i(x,R)),j}(F,h)}),p=p.substring(F.length+2).trim();continue}if(p[0]==="("){let F=r(p);if(F){C.push(a(F,h)),p=p.substring(F.length+2).trim();continue}}let N=f.length-p.length,T=Error("Unexpected character `"+f.substring(N,N+1)+"` at position "+(N+1)+". (`..."+f.substring(N-5,N+6)+"...`)");throw T.name="FormulaParseError",T}return C}function l(f){let h=0;for(let u=0,C=f.length,m,p=f.length-1;u<C;++u)(m=f.charCodeAt(u))>=65&&m<=90&&(h+=(m-64)*Math.pow(26,p)),--p;return h}return{parseFormula:a}}),v(w,"Data/Formula/FormulaTypes.js",[],function(){let d=["+","-","*","/","^","=","<","<=",">",">="];return{isFormula:function(b){return b instanceof Array},isFunction:function(b){return typeof b=="object"&&!(b instanceof Array)&&b.type==="function"},isOperator:function(b){return typeof b=="string"&&d.indexOf(b)>=0},isRange:function(b){return typeof b=="object"&&!(b instanceof Array)&&b.type==="range"},isReference:function(b){return typeof b=="object"&&!(b instanceof Array)&&b.type==="reference"},isValue:function(b){return typeof b=="boolean"||typeof b=="number"||typeof b=="string"}}}),v(w,"Data/Formula/FormulaProcessor.js",[w["Data/Formula/FormulaTypes.js"]],function(d){let{isFormula:b,isFunction:y,isOperator:c,isRange:g,isReference:s,isValue:n}=d,t=/ */,e=Number.MAX_VALUE/1.000000000001,r=Number.MAX_VALUE/1.000000000002,o=Number.MAX_VALUE,i={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},a={},l=/^[A-Z][A-Z\.]*$/;function f(D){switch(typeof D){case"boolean":return D?o:e;case"string":return r;case"number":return D;default:return NaN}}function h(D){return typeof D=="string"?D.toLowerCase().replace(t,"\0"):D}function u(D){switch(typeof D){case"boolean":return D?1:0;case"string":return parseFloat(D.replace(",","."));case"number":return D;default:return NaN}}function C(D,R,j){let O;switch(D){case"=":return h(R)===h(j);case"<":return typeof R==typeof j?h(R)<h(j):f(R)<f(j);case"<=":return typeof R==typeof j?h(R)<=h(j):f(R)<=f(j);case">":return typeof R==typeof j?h(R)>h(j):f(R)>f(j);case">=":return typeof R==typeof j?h(R)>=h(j):f(R)>=f(j)}switch(R=u(R),j=u(j),D){case"+":O=R+j;break;case"-":O=R-j;break;case"*":O=R*j;break;case"/":O=R/j;break;case"^":O=Math.pow(R,j);break;default:return NaN}return O%1?Math.round(1e9*O)/1e9:O}function m(D,R){return n(D)?D:g(D)?R&&p(D,R)||[]:y(D)?F(D,R):T(b(D)?D:[D],R)}function p(D,R){let j=R.getColumnNames().slice(D.beginColumn,D.endColumn+1),O=[];for(let A=0,x=j.length,M;A<x;++A){let L=R.getColumn(j[A],!0)||[];for(let P=D.beginRow,I=D.endRow+1;P<I;++P)typeof(M=L[P])=="string"&&M[0]==="="&&R!==R.modified&&(M=R.modified.getCell(j[A],P)),O.push(n(M)?M:NaN)}return O}function N(D,R){let j=R.getColumnNames()[D.column];if(j){let O=R.getCell(j,D.row);if(typeof O=="string"&&O[0]==="="&&R!==R.modified){let A=R.modified.getCell(j,D.row);return n(A)?A:NaN}return n(O)?O:NaN}return NaN}function T(D,R){let j;for(let O=0,A=D.length,x,M,L,P;O<A;++O){if(c(x=D[O])){M=x;continue}if(n(x)?P=x:b(x)?P=T(D,R):y(x)?P=n(L=F(x,R))?L:NaN:s(x)&&(P=R&&N(x,R)),P!==void 0){if(j===void 0)j=M?C(M,0,P):P;else{if(!M)return NaN;let I=D[O+1];c(I)&&i[I]>i[M]&&(P=C(I,P,T(D.slice(O+2))),O=A),j=C(M,j,P)}M=void 0,P=void 0}}return n(j)?j:NaN}function F(D,R,j){let O=a[D.name];if(O)try{return O(D.args,R)}catch{return NaN}let A=Error(`Function "${D.name}" not found.`);throw A.name="FormulaProcessError",A}return{asNumber:u,getArgumentValue:m,getArgumentsValues:function(D,R){let j=[];for(let O=0,A=D.length;O<A;++O)j.push(m(D[O],R));return j},getRangeValues:p,getReferenceValue:N,processFormula:T,processorFunctions:a,registerProcessorFunction:function(D,R){return l.test(D)&&!a[D]&&!!(a[D]=R)},translateReferences:function D(R,j=0,O=0){for(let A=0,x=R.length,M;A<x;++A)(M=R[A])instanceof Array?D(M,j,O):y(M)?D(M.args,j,O):g(M)?(M.beginColumnRelative&&(M.beginColumn+=j),M.beginRowRelative&&(M.beginRow+=O),M.endColumnRelative&&(M.endColumn+=j),M.endRowRelative&&(M.endRow+=O)):s(M)&&(M.columnRelative&&(M.column+=j),M.rowRelative&&(M.row+=O));return R}}}),v(w,"Data/Formula/Functions/ABS.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){let s=b(c[0],g);switch(typeof s){case"number":return Math.abs(s);case"object":{let n=[];for(let t=0,e=s.length,r;t<e;++t){if(typeof(r=s[t])!="number")return NaN;n.push(Math.abs(r))}return n}default:return NaN}}return d.registerProcessorFunction("ABS",y),y}),v(w,"Data/Formula/Functions/AND.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){for(let s=0,n=c.length,t;s<n;++s)if(!(t=b(c[s],g))||typeof t=="object"&&!y(t,g))return!1;return!0}return d.registerProcessorFunction("AND",y),y}),v(w,"Data/Formula/Functions/AVERAGE.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function y(c,g){let s=b(c,g),n=0,t=0;for(let e=0,r=s.length,o;e<r;++e)switch(typeof(o=s[e])){case"number":isNaN(o)||(++n,t+=o);break;case"object":for(let i=0,a=o.length,l;i<a;++i)typeof(l=o[i])!="number"||isNaN(l)||(++n,t+=l)}return n?t/n:0}return d.registerProcessorFunction("AVERAGE",y),y}),v(w,"Data/Formula/Functions/AVERAGEA.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){let s=0,n=0;for(let t=0,e=c.length,r;t<e;++t)switch(typeof(r=b(c[t],g))){case"boolean":++s,n+=r?1:0;continue;case"number":isNaN(r)||(++s,n+=r);continue;case"string":++s;continue;default:for(let o=0,i=r.length,a;o<i;++o)switch(typeof(a=r[o])){case"boolean":++s,n+=a?1:0;continue;case"number":isNaN(a)||(++s,n+=a);continue;case"string":++s;continue}continue}return s?n/s:0}return d.registerProcessorFunction("AVERAGEA",y),y}),v(w,"Data/Formula/Functions/COUNT.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(y,c){let g=d.getArgumentsValues(y,c),s=0;for(let n=0,t=g.length,e;n<t;++n)switch(typeof(e=g[n])){case"number":!isNaN(e)&&++s;break;case"object":s+=b(e,c)}return s}return d.registerProcessorFunction("COUNT",b),b}),v(w,"Data/Formula/Functions/COUNTA.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(y,c){let g=d.getArgumentsValues(y,c),s=0;for(let n=0,t=g.length,e;n<t;++n){switch(typeof(e=g[n])){case"number":if(isNaN(e))continue;break;case"object":s+=b(e,c);continue;case"string":if(!e)continue}++s}return s}return d.registerProcessorFunction("COUNTA",b),b}),v(w,"Data/Formula/Functions/IF.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){return b(c[0],g)?b(c[1],g):b(c[2],g)}return d.registerProcessorFunction("IF",y),y}),v(w,"Data/Formula/Functions/ISNA.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){let s=b(c[0],g);return typeof s!="number"||isNaN(s)}return d.registerProcessorFunction("ISNA",y),y}),v(w,"Data/Formula/Functions/MAX.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function y(c,g){let s=b(c,g),n=Number.NEGATIVE_INFINITY;for(let t=0,e=s.length,r;t<e;++t)switch(typeof(r=s[t])){case"number":r>n&&(n=r);break;case"object":(r=y(r))>n&&(n=r)}return isFinite(n)?n:0}return d.registerProcessorFunction("MAX",y),y}),v(w,"Data/Formula/Functions/MEDIAN.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(y,c){let g=[],s=d.getArgumentsValues(y,c);for(let e=0,r=s.length,o;e<r;++e)switch(typeof(o=s[e])){case"number":isNaN(o)||g.push(o);break;case"object":for(let i=0,a=o.length,l;i<a;++i)typeof(l=o[i])!="number"||isNaN(l)||g.push(l)}let n=g.length;if(!n)return NaN;let t=Math.floor(n/2);return n%2?g[t]:(g[t-1]+g[t])/2}return d.registerProcessorFunction("MEDIAN",b),b}),v(w,"Data/Formula/Functions/MIN.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function y(c,g){let s=b(c,g),n=Number.POSITIVE_INFINITY;for(let t=0,e=s.length,r;t<e;++t)switch(typeof(r=s[t])){case"number":r<n&&(n=r);break;case"object":(r=y(r))<n&&(n=r)}return isFinite(n)?n:0}return d.registerProcessorFunction("MIN",y),y}),v(w,"Data/Formula/Functions/MOD.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){let s=b(c[0],g),n=b(c[1],g);return typeof s=="object"&&(s=s[0]),typeof n=="object"&&(n=n[0]),typeof s!="number"||typeof n!="number"||n===0?NaN:s%n}return d.registerProcessorFunction("MOD",y),y}),v(w,"Data/Formula/Functions/MODE.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(g,s){let n={},t=d.getArgumentsValues(g,s);for(let e=0,r=t.length,o;e<r;++e)switch(typeof(o=t[e])){case"number":isNaN(o)||(n[o]=(n[o]||0)+1);break;case"object":for(let i=0,a=o.length,l;i<a;++i)typeof(l=o[i])!="number"||isNaN(l)||(n[l]=(n[l]||0)+1)}return n}function y(g,s){let n=b(g,s),t=Object.keys(n);if(!t.length)return NaN;let e=[parseFloat(t[0])],r=n[t[0]];for(let o=1,i=t.length,a,l;o<i;++o)r<(l=n[a=t[o]])?(e=[parseFloat(a)],r=l):r===l&&e.push(parseFloat(a));return r>1?e:NaN}function c(g,s){let n=b(g,s),t=Object.keys(n);if(!t.length)return NaN;let e=parseFloat(t[0]),r=n[t[0]];for(let o=1,i=t.length,a,l,f;o<i;++o)r<(f=n[a=t[o]])?(e=parseFloat(a),r=f):r===f&&e>(l=parseFloat(a))&&(e=l,r=f);return r>1?e:NaN}return d.registerProcessorFunction("MODE",c),d.registerProcessorFunction("MODE.MULT",y),d.registerProcessorFunction("MODE.SNGL",c),{MULT:y,SNGL:c}}),v(w,"Data/Formula/Functions/NOT.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){let s=b(c[0],g);switch(typeof s=="object"&&(s=s[0]),typeof s){case"boolean":case"number":return!s}return NaN}return d.registerProcessorFunction("NOT",y),y}),v(w,"Data/Formula/Functions/OR.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){for(let s=0,n=c.length,t;s<n;++s)if(typeof(t=b(c[s],g))=="object"){if(y(t,g))return!0}else if(t)return!0;return!1}return d.registerProcessorFunction("OR",y),y}),v(w,"Data/Formula/Functions/PRODUCT.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentsValues:b}=d;function y(c,g){let s=b(c,g),n=1,t=!1;for(let e=0,r=s.length,o;e<r;++e)switch(typeof(o=s[e])){case"number":isNaN(o)||(t=!0,n*=o);break;case"object":t=!0,n*=y(o,g)}return t?n:0}return d.registerProcessorFunction("PRODUCT",y),y}),v(w,"Data/Formula/Functions/SUM.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){function b(y,c){let g=d.getArgumentsValues(y,c),s=0;for(let n=0,t=g.length,e;n<t;++n)switch(typeof(e=g[n])){case"number":isNaN(e)||(s+=e);break;case"object":s+=b(e,c)}return s}return d.registerProcessorFunction("SUM",b),b}),v(w,"Data/Formula/Functions/XOR.js",[w["Data/Formula/FormulaProcessor.js"]],function(d){let{getArgumentValue:b}=d;function y(c,g){for(let s=0,n=c.length,t,e;s<n;++s)switch(typeof(e=b(c[s],g))){case"boolean":case"number":if(t===void 0)t=!!e;else if(!!e!==t)return!0;break;case"object":for(let r=0,o=e.length,i;r<o;++r)switch(typeof(i=e[r])){case"boolean":case"number":if(t===void 0)t=!!i;else if(!!i!==t)return!0}}return!1}return d.registerProcessorFunction("XOR",y),y}),v(w,"Data/Formula/Formula.js",[w["Data/Formula/FormulaParser.js"],w["Data/Formula/FormulaProcessor.js"],w["Data/Formula/FormulaTypes.js"]],function(d,b,y){return{...d,...b,...y}}),v(w,"Data/Converters/CSVConverter.js",[w["Data/Converters/DataConverter.js"],w["Core/Utilities.js"]],function(d,b){let{merge:y}=b;class c extends d{constructor(s){let n=y(c.defaultOptions,s);super(n),this.columns=[],this.headers=[],this.dataTypes=[],this.options=n}export(s,n=this.options){let{useLocalDecimalPoint:t,lineDelimiter:e}=n,r=this.options.firstRowAsNames!==!1,{decimalPoint:o,itemDelimiter:i}=n;o||(o=i!==","&&t?1.1.toLocaleString()[1]:"."),i||(i=o===","?";":",");let a=s.getSortedColumns(n.usePresentationOrder),l=Object.keys(a),f=[],h=l.length,u=[];r&&f.push(l.map(C=>`"${C}"`).join(i));for(let C=0;C<h;C++){let m,p=l[C],N=a[p],T=N.length,F=s.whatIs(p);F&&(m=F.dataType);for(let D=0;D<T;D++){let R=N[D];if(u[D]||(u[D]=[]),m==="string"?R='"'+R+'"':typeof R=="number"?R=String(R).replace(".",o):typeof R=="string"&&(R=`"${R}"`),u[D][C]=R,C===h-1){let j=C;for(;u[D].length>2&&u[D][j]===void 0;)u[D].pop(),j--;f.push(u[D].join(i))}}}return f.join(e)}parse(s,n){let t=this.dataTypes,e=y(this.options,s),{beforeParse:r,lineDelimiter:o,firstRowAsNames:i,itemDelimiter:a}=e,l,f=0,{csv:h,startRow:u,endRow:C}=e,m;if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:n,headers:this.headers}),h&&r&&(h=r(h)),h){if(l=h.replace(/\r\n|\r/g,`
`).split(o||`
`),(!u||u<0)&&(u=0),(!C||C>=l.length)&&(C=l.length-1),a||(this.guessedItemDelimiter=this.guessDelimiter(l)),i){let N=l[0].split(a||this.guessedItemDelimiter||",");for(let T=0;T<N.length;T++)N[T]=N[T].trim().replace(/^["']|["']$/g,"");this.headers=N,u++}let p=0;for(f=u;f<=C;f++)l[f][0]==="#"?p++:this.parseCSVRow(l[f],f-u-p);t.length&&t[0].length&&t[0][1]==="date"&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let N=0,T=this.columns.length;N<T;++N){m=this.columns[N];for(let F=0,D=m.length;F<D;++F)if(m[F]&&typeof m[F]=="string"){let R=this.asGuessedType(m[F]);R instanceof Date&&(R=R.getTime()),this.columns[N][F]=R}}}this.emit({type:"afterParse",columns:this.columns,detail:n,headers:this.headers})}parseCSVRow(s,n){let t=this,e=t.columns||[],r=t.dataTypes,{startColumn:o,endColumn:i}=t.options,a=t.options.itemDelimiter||t.guessedItemDelimiter,{decimalPoint:l}=t.options;l&&l!==a||(l=t.guessedDecimalPoint||".");let f=0,h="",u="",C=0,m=0,p=F=>{h=s[F]},N=F=>{r.length<m+1&&r.push([F]),r[m][r[m].length-1]!==F&&r[m].push(F)},T=()=>{if(o>C||C>i){++C,u="";return}if(typeof u=="string"?!isNaN(parseFloat(u))&&isFinite(u)?(u=parseFloat(u),N("number")):isNaN(Date.parse(u))?N("string"):(u=u.replace(/\//g,"-"),N("date")):N("number"),e.length<m+1&&e.push([]),typeof u!="number"&&t.guessType(u)!=="number"&&l){let F=u;u=u.replace(l,"."),t.guessType(u)!=="number"&&(u=F)}e[m][n]=u,u="",++m,++C};if(s.trim().length&&s.trim()[0]!=="#"){for(;f<s.length;f++){if(p(f),h==="#"&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(s.substring(f))){T();return}if(h==='"')for(p(++f);f<s.length&&h!=='"';)u+=h,p(++f);else h===a?T():u+=h}T()}}guessDelimiter(s){let n=0,t=0,e,r={",":0,";":0,"	":0},o=s.length;for(let i=0;i<o;i++){let a=!1,l,f,h,u="";if(i>13)break;let C=s[i];for(let m=0;m<C.length&&(l=C[m],f=C[m+1],h=C[m-1],l!=="#");m++){if(l==='"')if(a){if(h!=='"'&&f!=='"'){for(;f===" "&&m<C.length;)f=C[++m];r[f]!==void 0&&r[f]++,a=!1}}else a=!0;else r[l]!==void 0?(isNaN(Date.parse(u=u.trim()))?(isNaN(Number(u))||!isFinite(Number(u)))&&r[l]++:r[l]++,u=""):u+=l;l===","&&t++,l==="."&&n++}}return r[";"]>r[","]?e=";":(r[","],r[";"],e=","),n>t?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return d.getTableFromColumns(this.columns,this.headers)}}return c.defaultOptions={...d.defaultOptions,lineDelimiter:`
`},c}),v(w,"Data/Connectors/CSVConnector.js",[w["Data/Converters/CSVConverter.js"],w["Data/Connectors/DataConnector.js"],w["Core/Utilities.js"]],function(d,b,y){let{merge:c}=y;class g extends b{constructor(n){let t=c(g.defaultOptions,n);super(t),this.converter=new d(t),this.options=t,t.enablePolling&&this.startPolling(1e3*Math.max(t.dataRefreshRate||0,1))}load(n){let t=this,e=t.converter,r=t.table,{csv:o,csvURL:i,dataModifier:a}=t.options;return t.emit({type:"load",csv:o,detail:n,table:r}),Promise.resolve(i?fetch(i).then(l=>l.text()):o||"").then(l=>(l&&(r.deleteColumns(),e.parse({csv:l}),r.setColumns(e.getTable().getColumns())),t.setModifierOptions(a).then(()=>l))).then(l=>(t.emit({type:"afterLoad",csv:l,detail:n,table:r}),t)).catch(l=>{throw t.emit({type:"loadError",detail:n,error:l,table:r}),l})}}return g.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},b.registerType("CSV",g),g}),v(w,"Data/Converters/JSONConverter.js",[w["Data/Converters/DataConverter.js"],w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b,y){let{error:c,isArray:g,merge:s,objectEach:n}=y;class t extends d{constructor(r){let o=s(t.defaultOptions,r);super(o),this.columns=[],this.headers=[],this.options=o,this.table=new b}parse(r,o){let{beforeParse:i,orientation:a,firstRowAsNames:l,columnNames:f}=r=s(this.options,r),h=r.data;if(h){if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:o,headers:this.headers}),i&&(h=i(h)),h=h.slice(),a==="columns")for(let u=0,C=h.length;u<C;u++){let m=h[u];if(!(m instanceof Array))return;this.headers instanceof Array?(l?this.headers.push(`${m.shift()}`):f&&f instanceof Array&&this.headers.push(f[u]),this.table.setColumn(this.headers[u]||u.toString(),m)):c("JSONConverter: Invalid `columnNames` option.",!1)}else if(a==="rows"){l?this.headers=h.shift():f&&(this.headers=f);for(let u=0,C=h.length;u<C;u++){let m=h[u];if(g(m))for(let p=0,N=m.length;p<N;p++)this.columns.length<p+1&&this.columns.push([]),this.columns[p].push(m[p]),this.headers instanceof Array?this.table.setColumn(this.headers[p]||p.toString(),this.columns[p]):c("JSONConverter: Invalid `columnNames` option.",!1);else{let p=this.headers;if(p&&!(p instanceof Array)){let N={};n(p,(T,F)=>{N[F]=T.reduce((D,R)=>D[R],m)}),m=N}this.table.setRows([m],u)}}}this.emit({type:"afterParse",columns:this.columns,detail:o,headers:this.headers})}}getTable(){return this.table}}return t.defaultOptions={...d.defaultOptions,data:[],orientation:"rows"},t}),v(w,"Data/Connectors/JSONConnector.js",[w["Data/Connectors/DataConnector.js"],w["Core/Utilities.js"],w["Data/Converters/JSONConverter.js"]],function(d,b,y){let{merge:c}=b;class g extends d{constructor(n){let t=c(g.defaultOptions,n);super(t),this.converter=new y(t),this.options=t,t.enablePolling&&this.startPolling(1e3*Math.max(t.dataRefreshRate||0,1))}load(n){let t=this,e=t.converter,r=t.table,{data:o,dataUrl:i,dataModifier:a}=t.options;return t.emit({type:"load",data:o,detail:n,table:r}),Promise.resolve(i?fetch(i).then(l=>l.json()):o||[]).then(l=>(l&&(r.deleteColumns(),e.parse({data:l}),r.setColumns(e.getTable().getColumns())),t.setModifierOptions(a).then(()=>l))).then(l=>(t.emit({type:"afterLoad",data:l,detail:n,table:r}),t)).catch(l=>{throw t.emit({type:"loadError",detail:n,error:l,table:r}),l})}}return g.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},d.registerType("JSON",g),g}),v(w,"Data/Converters/GoogleSheetsConverter.js",[w["Data/Converters/DataConverter.js"],w["Core/Utilities.js"]],function(d,b){let{merge:y,uniqueKey:c}=b;class g extends d{constructor(n){let t=y(g.defaultOptions,n);super(t),this.columns=[],this.header=[],this.options=t}parse(n,t){var l;let e,r=y(this.options,n),o=(((l=r.json)==null?void 0:l.values)||[]).map(f=>f.slice());if(o.length===0)return!1;this.header=[],this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.header});let{beforeParse:i,json:a}=r;i&&a&&(o=i(a.values)),this.columns=o;for(let f=0,h=o.length;f<h;f++){e=o[f],this.header[f]=r.firstRowAsNames?`${e.shift()}`:c();for(let u=0,C=e.length;u<C;++u)if(e[u]&&typeof e[u]=="string"){let m=this.asGuessedType(e[u]);m instanceof Date&&(m=m.getTime()),this.columns[f][u]=m}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.header})}getTable(){return d.getTableFromColumns(this.columns,this.header)}}return g.defaultOptions={...d.defaultOptions},g}),v(w,"Data/Connectors/GoogleSheetsConnector.js",[w["Data/Connectors/DataConnector.js"],w["Data/Converters/GoogleSheetsConverter.js"],w["Core/Utilities.js"]],function(d,b,y){let{merge:c,pick:g}=y;class s extends d{constructor(t){let e=c(s.defaultOptions,t);super(e),this.converter=new b(e),this.options=e}load(t){let e=this,r=e.converter,o=e.table,{dataModifier:i,dataRefreshRate:a,enablePolling:l,firstRowAsNames:f,googleAPIKey:h,googleSpreadsheetKey:u}=e.options,C=s.buildFetchURL(h,u,e.options);if(e.emit({type:"load",detail:t,table:o,url:C}),!URL.canParse(C))throw Error("Invalid URL: "+C);return fetch(C).then(m=>m.json()).then(m=>{if(typeof m=="object"&&m&&typeof m.error=="object"&&m.error&&typeof m.error.code=="number"&&typeof m.error.message=="string"&&typeof m.error.status=="string")throw Error(m.error.message);return r.parse({firstRowAsNames:f,json:m}),o.deleteColumns(),o.setColumns(r.getTable().getColumns()),e.setModifierOptions(i)}).then(()=>(e.emit({type:"afterLoad",detail:t,table:o,url:C}),l&&setTimeout(()=>e.load(),1e3*Math.max(a||0,1)),e)).catch(m=>{throw e.emit({type:"loadError",detail:t,error:m,table:o}),m})}}return s.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0},function(n){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function e(r={}){let{endColumn:o,endRow:i,googleSpreadsheetRange:a,startColumn:l,startRow:f}=r;return a||(t[l||0]||"A")+(Math.max(f||0,0)+1)+":"+(t[g(o,25)]||"Z")+(i?Math.max(i,0):"Z")}n.buildFetchURL=function(r,o,i={}){let a=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${o}/values/`),l=i.onlyColumnNames?"A1:Z1":e(i);a.pathname+=l;let f=a.searchParams;return f.set("alt","json"),i.onlyColumnNames||(f.set("dateTimeRenderOption","FORMATTED_STRING"),f.set("majorDimension","COLUMNS"),f.set("valueRenderOption","UNFORMATTED_VALUE")),f.set("prettyPrint","false"),f.set("key",r),a.href},n.buildQueryRange=e}(s||(s={})),d.registerType("GoogleSheets",s),s}),v(w,"Data/Converters/HTMLTableConverter.js",[w["Data/Converters/DataConverter.js"],w["Core/Utilities.js"]],function(d,b){let{merge:y}=b;class c extends d{constructor(s){let n=y(c.defaultOptions,s);super(n),this.columns=[],this.headers=[],this.options=n,n.tableElement&&(this.tableElement=n.tableElement,this.tableElementID=n.tableElement.id)}export(s,n=this.options){let t=n.firstRowAsNames!==!1,e=n.useMultiLevelHeaders,r=s.getSortedColumns(n.usePresentationOrder),o=Object.keys(r),i=[],a=o.length,l=[],f="";if(t){let u=[];if(e){for(let C of o){let m=(r[C].shift()||"").toString();u.push(m)}f=this.getTableHeaderHTML(o,u,n)}else f=this.getTableHeaderHTML(void 0,o,n)}for(let u=0;u<a;u++){let C=r[o[u]],m=C.length;for(let p=0;p<m;p++){let N=C[p];l[p]||(l[p]=[]),typeof N=="string"||typeof N=="number"||N===void 0||(N=(N||"").toString()),l[p][u]=this.getCellHTMLFromValue(u?"td":"th",null,u?"":'scope="row"',N),u===a-1&&i.push("<tr>"+l[p].join("")+"</tr>")}}let h="";return n.tableCaption&&(h='<caption class="highcharts-table-caption">'+n.tableCaption+"</caption>"),"<table>"+h+f+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(s,n,t,e,r){let o=e,i="text"+(n?" "+n:"");return typeof o=="number"?(o=o.toString(),r===","&&(o=o.replace(".",r)),i="number"):e||(o="",i="empty"),"<"+s+(t?" "+t:"")+' class="'+i+'">'+o+"</"+s+">"}getTableHeaderHTML(s=[],n=[],t=this.options){let{useMultiLevelHeaders:e,useRowspanHeaders:r}=t,o="<thead>",i=0,a=n&&n.length,l,f=0,h;if(e&&s&&n&&!function(u,C){let m=u.length;if(C.length!==m)return!1;for(;--m;)if(u[m]!==C[m])return!1;return!0}(s,n)){for(o+="<tr>";i<a;++i)(l=s[i])===s[i+1]?++f:f?(o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(f+1)+'"',l),f=0):(l===n[i]?r?(h=2,delete n[i]):(h=1,n[i]=""):h=1,o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(h>1?' valign="top" rowspan="'+h+'"':""),l));o+="</tr>"}if(n){for(o+="<tr>",i=0,a=n.length;i<a;++i)n[i]!==void 0&&(o+=this.getCellHTMLFromValue("th",null,'scope="col"',n[i]));o+="</tr>"}return o+"</thead>"}parse(s,n){let t=[],e=[],r=y(this.options,s),{endRow:o,startColumn:i,endColumn:a,firstRowAsNames:l}=r,f=r.tableElement||this.tableElement;if(!(f instanceof HTMLElement)){this.emit({type:"parseError",columns:t,detail:n,headers:e,error:"Not a valid HTML Table"});return}this.tableElement=f,this.tableElementID=f.id,this.emit({type:"parse",columns:this.columns,detail:n,headers:this.headers});let h=f.getElementsByTagName("tr"),u=h.length,C=0,m,{startRow:p}=r;if(l&&u){let N=h[0].children,T=N.length;for(let F=i;F<T&&!(F>a);F++)((m=N[F]).tagName==="TD"||m.tagName==="TH")&&e.push(m.innerHTML);p++}for(;C<u;){if(C>=p&&C<=o){let N=h[C].children,T=N.length,F=0;for(;F<T;){let D=F-i,R=t[D];if(((m=N[F]).tagName==="TD"||m.tagName==="TH")&&F>=i&&F<=a){t[D]||(t[D]=[]);let j=this.asGuessedType(m.innerHTML);j instanceof Date&&(j=j.getTime()),t[D][C-p]=j;let O=1;for(;C-p>=O&&R[C-p-O]===void 0;)R[C-p-O]=null,O++}F++}}C++}this.columns=t,this.headers=e,this.emit({type:"afterParse",columns:t,detail:n,headers:e})}getTable(){return d.getTableFromColumns(this.columns,this.headers)}}return c.defaultOptions={...d.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},c}),v(w,"Data/Connectors/HTMLTableConnector.js",[w["Data/Connectors/DataConnector.js"],w["Core/Globals.js"],w["Data/Converters/HTMLTableConverter.js"],w["Core/Utilities.js"]],function(d,b,y,c){let{win:g}=b,{merge:s}=c;class n extends d{constructor(e){let r=s(n.defaultOptions,e);super(r),this.converter=new y(r),this.options=r}load(e){let r,o=this,i=o.converter,a=o.table,{dataModifier:l,table:f}=o.options;if(o.emit({type:"load",detail:e,table:a,tableElement:o.tableElement}),typeof f=="string"?(o.tableID=f,r=g.document.getElementById(f)):(r=f,o.tableID=r.id),o.tableElement=r||void 0,!o.tableElement){let h="HTML table not provided, or element with ID not found";return o.emit({type:"loadError",detail:e,error:h,table:a}),Promise.reject(Error(h))}return i.parse(s({tableElement:o.tableElement},o.options),e),a.deleteColumns(),a.setColumns(i.getTable().getColumns()),o.setModifierOptions(l).then(()=>(o.emit({type:"afterLoad",detail:e,table:a,tableElement:o.tableElement}),o))}}return n.defaultOptions={table:""},d.registerType("HTMLTable",n),n}),v(w,"Data/Modifiers/ChainModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Core/Utilities.js"]],function(d,b){let{merge:y}=b;class c extends d{constructor(s,...n){super(),this.chain=n,this.options=y(c.defaultOptions,s);let t=this.options.chain||[];for(let e=0,r=t.length,o,i;e<r;++e)(o=t[e]).type&&(i=d.types[o.type])&&n.push(new i(o))}add(s,n){this.emit({type:"addModifier",detail:n,modifier:s}),this.chain.push(s),this.emit({type:"addModifier",detail:n,modifier:s})}clear(s){this.emit({type:"clearChain",detail:s}),this.chain.length=0,this.emit({type:"afterClearChain",detail:s})}async modify(s,n){let t=this.options.reverse?this.chain.slice().reverse():this.chain.slice();s.modified===s&&(s.modified=s.clone(!1,n));let e=s;for(let r=0,o=t.length;r<o;++r){try{await t[r].modify(e,n)}catch(i){throw this.emit({type:"error",detail:n,table:s}),i}e=e.modified}return s.modified=e,s}modifyCell(s,n,t,e,r){let o=this.options.reverse?this.chain.reverse():this.chain;if(o.length){let i=s.clone();for(let a=0,l=o.length;a<l;++a)o[a].modifyCell(i,n,t,e,r),i=i.modified;s.modified=i}return s}modifyColumns(s,n,t,e){let r=this.options.reverse?this.chain.reverse():this.chain.slice();if(r.length){let o=s.clone();for(let i=0,a=r.length;i<a;++i)r[i].modifyColumns(o,n,t,e),o=o.modified;s.modified=o}return s}modifyRows(s,n,t,e){let r=this.options.reverse?this.chain.reverse():this.chain.slice();if(r.length){let o=s.clone();for(let i=0,a=r.length;i<a;++i)r[i].modifyRows(o,n,t,e),o=o.modified;s.modified=o}return s}modifyTable(s,n){this.emit({type:"modify",detail:n,table:s});let t=this.options.reverse?this.chain.reverse():this.chain.slice(),e=s.modified;for(let r=0,o=t.length;r<o;++r)e=t[r].modifyTable(e,n).modified;return s.modified=e,this.emit({type:"afterModify",detail:n,table:s}),s}remove(s,n){let t=this.chain;this.emit({type:"removeModifier",detail:n,modifier:s}),t.splice(t.indexOf(s),1),this.emit({type:"afterRemoveModifier",detail:n,modifier:s})}}return c.defaultOptions={type:"Chain"},d.registerType("Chain",c),c}),v(w,"Data/Modifiers/InvertModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Core/Utilities.js"]],function(d,b){let{merge:y}=b;class c extends d{constructor(s){super(),this.options=y(c.defaultOptions,s)}modifyCell(s,n,t,e,r){let o=s.modified,i=o.getRowIndexBy("columnNames",n);return i===void 0?o.setColumns(this.modifyTable(s.clone()).getColumns(),void 0,r):o.setCell(`${t}`,i,e,r),s}modifyColumns(s,n,t,e){let r=s.modified,o=r.getColumn("columnNames")||[],i=s.getColumnNames(),a=s.getRowCount()!==o.length;if(!a){for(let l=0,f=i.length;l<f;++l)if(i[l]!==o[l]){a=!0;break}}if(a)return this.modifyTable(s,e);i=Object.keys(n);for(let l=0,f=i.length,h,u,C;l<f;++l){h=n[u=i[l]],C=r.getRowIndexBy("columnNames",u)||r.getRowCount();for(let m=0,p=t,N=h.length;m<N;++m,++p)r.setCell(`${p}`,C,h[m],e)}return s}modifyRows(s,n,t,e){let r=s.getColumnNames(),o=s.modified,i=o.getColumn("columnNames")||[],a=s.getRowCount()!==i.length;if(!a){for(let l=0,f=r.length;l<f;++l)if(r[l]!==i[l]){a=!0;break}}if(a)return this.modifyTable(s,e);for(let l=0,f=t,h=n.length,u;l<h;++l,++f)if((u=n[l])instanceof Array)o.setColumn(`${f}`,u);else for(let C=0,m=r.length;C<m;++C)o.setCell(`${f}`,C,u[r[C]],e);return s}modifyTable(s,n){this.emit({type:"modify",detail:n,table:s});let t=s.modified;if(s.hasColumns(["columnNames"])){let e=((s.deleteColumns(["columnNames"])||{}).columnNames||[]).map(o=>`${o}`),r={};for(let o=0,i=s.getRowCount(),a;o<i;++o)(a=s.getRow(o))&&(r[e[o]]=a);t.deleteColumns(),t.setColumns(r)}else{let e={};for(let r=0,o=s.getRowCount(),i;r<o;++r)(i=s.getRow(r))&&(e[`${r}`]=i);e.columnNames=s.getColumnNames(),t.deleteColumns(),t.setColumns(e)}return this.emit({type:"afterModify",detail:n,table:s}),s}}return c.defaultOptions={type:"Invert"},d.registerType("Invert",c),c}),v(w,"Data/Modifiers/MathModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Data/Formula/FormulaParser.js"],w["Data/Formula/FormulaProcessor.js"]],function(d,b,y){class c extends d{constructor(s){super(),this.options={...c.defaultOptions,...s}}modifyTable(s,n){this.emit({type:"modify",detail:n,table:s});let t=this.options.alternativeSeparators,e=this.options.formulaColumns||s.getColumnNames(),r=s.modified;for(let i=0,a=e.length,l;i<a;++i)l=e[i],e.indexOf(l)>=0&&r.setColumn(l,this.processColumn(s,l));let o=this.options.columnFormulas||[];for(let i=0,a=o.length,l,f;i<a;++i)l=o[i],f=b.parseFormula(l.formula,t),r.setColumn(l.column,this.processColumnFormula(f,s,l.rowStart,l.rowEnd));return this.emit({type:"afterModify",detail:n,table:s}),s}processColumn(s,n,t=0){let e=this.options.alternativeSeparators,r=(s.getColumn(n,!0)||[]).slice(t>0?t:0);for(let o=0,i=r.length,a=[],l;o<i;++o)if(typeof(l=r[o])=="string"&&l[0]==="=")try{a=l===""?a:b.parseFormula(l.substring(1),e),r[o]=y.processFormula(a,s)}catch{r[o]=NaN}return r}processColumnFormula(s,n,t=0,e=n.getRowCount()){t=t>=0?t:0,e=e>=0?e:n.getRowCount()+e;let r=[],o=n.modified;for(let i=0,a=e-t;i<a;++i)try{r[i]=y.processFormula(s,o)}catch{r[i]=NaN}finally{s=y.translateReferences(s,0,1)}return r}}return c.defaultOptions={type:"Math",alternativeSeparators:!1},d.registerType("Math",c),c}),v(w,"Data/Modifiers/RangeModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Core/Utilities.js"]],function(d,b){let{merge:y}=b;class c extends d{constructor(s){super(),this.options=y(c.defaultOptions,s)}modifyTable(s,n){this.emit({type:"modify",detail:n,table:s});let t=[],{additive:e,ranges:r,strict:o}=this.options;if(r.length){let i=s.modified,a=s.getColumns(),l=[];for(let f=0,h=r.length,u,C;f<h;++f)if(u=r[f],!o||typeof u.minValue==typeof u.maxValue){f>0&&!e&&(i.deleteRows(),i.setRows(l),i.setOriginalRowIndexes(t,!0),a=i.getColumns(),l=[],t=[]),C=a[u.column]||[];for(let m=0,p=C.length,N,T,F;m<p;++m){switch(typeof(N=C[m])){default:continue;case"boolean":case"number":case"string":}(!o||typeof N==typeof u.minValue)&&N>=u.minValue&&N<=u.maxValue&&(e?(T=s.getRow(m),F=s.getOriginalRowIndex(m)):(T=i.getRow(m),F=i.getOriginalRowIndex(m)),T&&(l.push(T),t.push(F)))}}i.deleteRows(),i.setRows(l),i.setOriginalRowIndexes(t)}return this.emit({type:"afterModify",detail:n,table:s}),s}}return c.defaultOptions={type:"Range",ranges:[]},d.registerType("Range",c),c}),v(w,"Data/Modifiers/SortModifier.js",[w["Data/Modifiers/DataModifier.js"],w["Data/DataTable.js"],w["Core/Utilities.js"]],function(d,b,y){let{merge:c}=y;class g extends d{static ascending(n,t){return(n||0)<(t||0)?-1:(n||0)>(t||0)?1:0}static descending(n,t){return(t||0)<(n||0)?-1:(t||0)>(n||0)?1:0}constructor(n){super(),this.options=c(g.defaultOptions,n)}getRowReferences(n){let t=n.getRows(),e=[];for(let r=0,o=t.length;r<o;++r)e.push({index:r,row:t[r]});return e}modifyCell(n,t,e,r,o){let{orderByColumn:i,orderInColumn:a}=this.options;return t===i&&(a?(n.modified.setCell(t,e,r),n.modified.setColumn(a,this.modifyTable(new b({columns:n.getColumns([i,a])})).modified.getColumn(a))):this.modifyTable(n,o)),n}modifyColumns(n,t,e,r){let{orderByColumn:o,orderInColumn:i}=this.options,a=Object.keys(t);return a.indexOf(o)>-1&&(i&&t[a[0]].length?(n.modified.setColumns(t,e),n.modified.setColumn(i,this.modifyTable(new b({columns:n.getColumns([o,i])})).modified.getColumn(i))):this.modifyTable(n,r)),n}modifyRows(n,t,e,r){let{orderByColumn:o,orderInColumn:i}=this.options;return i&&t.length?(n.modified.setRows(t,e),n.modified.setColumn(i,this.modifyTable(new b({columns:n.getColumns([o,i])})).modified.getColumn(i))):this.modifyTable(n,r),n}modifyTable(n,t){this.emit({type:"modify",detail:t,table:n});let e=n.getColumnNames(),r=n.getRowCount(),o=this.getRowReferences(n),{direction:i,orderByColumn:a,orderInColumn:l}=this.options,f=i==="asc"?g.ascending:g.descending,h=e.indexOf(a),u=n.modified;if(h!==-1&&o.sort((C,m)=>f(C.row[h],m.row[h])),l){let C=[];for(let m=0;m<r;++m)C[o[m].index]=m;u.setColumns({[l]:C})}else{let C,m=[],p=[];for(let N=0;N<r;++N)C=o[N],m.push(u.getOriginalRowIndex(C.index)),p.push(C.row);u.setRows(p,0),u.setOriginalRowIndexes(m)}return this.emit({type:"afterModify",detail:t,table:n}),n}}return g.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},d.registerType("Sort",g),g}),v(w,"masters/modules/data-tools.src.js",[w["Core/Globals.js"],w["Data/Connectors/DataConnector.js"],w["Data/Converters/DataConverter.js"],w["Data/DataCursor.js"],w["Data/Modifiers/DataModifier.js"],w["Data/DataPool.js"],w["Data/DataTable.js"],w["Data/Formula/Formula.js"]],function(d,b,y,c,g,s,n,t){return d.DataConnector=d.DataConnector||b,d.DataConverter=d.DataConverter||y,d.DataCursor=d.DataCursor||c,d.DataModifier=d.DataModifier||g,d.DataPool=d.DataPool||s,d.DataTable=d.DataTable||n,d.Formula=d.Formula||t,d})})})(V);var U=V.exports;const $=Y(U),G=k({__proto__:null,default:$},[U]);export{G as d};
